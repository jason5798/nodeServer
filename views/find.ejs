<%- include page/header_datepicker %>


		<div class="panel-body">

			<form method="post">
				<div class="col-md-12">
					<div class="form-group">
						<label>日期</label>
						<input id="datepicker1" name="datepicker1" type="text" value="<%= mdate %>"/>
					</div> <!-- form-group -->
				</div> <!-- col-md-12 -->

				<div class="col-md-3">
					<div class="form-group">
						<label>選擇裝置</label>
						<select id="selected_mac" name="mac">
							<% if(units) { %>
								<% for(var i=0;i<units.length;i++){ %>
									<% if(mac === units[i].macAddr){ %>
										<option value = "<%= units[i].macAddr %>" selected>
									<% }else{ %>
										<option value = "<%= units[i].macAddr %>" >
									<% } %>

										<%= units[i].name %>
									</option>
								<% } %>
							<% } %>
						</select>
					</div> <!-- form-group -->
				</div> <!-- col-md-3 -->

				<div class="col-md-3">
					<div class="form-group">
						<label>選擇時間</label>
						<select "selected_time" name="time_option">
							<% if(option == 0){ %>
								<option value="0" selected>一天</option>
							<% }else{ %>
								<option value="0">一天</option>
							<% } %>

							<% if(option == 1){ %>
								<option value="1" selected>一周</option>
							<% }else{ %>
								<option value="1">一周</option>
							<% } %>

							<% if(option == 2){ %>
								<option value="2" selected>一個月</option>
							<% }else{ %>
								<option value="2">一個月</option>
							<% } %>

							<% if(option == 3){ %>
							test
								<option value="3" selected>三個月</option>
							<% }else{ %>
								<option value="3">三個月</option>
							<% } %>

						</select>
					</div> <!-- form-group -->
				</div> <!-- col-md-3 -->

				<div class="col-md-3">
					<div class="form-group">
						<% if (user.authz.a05==true) { %>
							<button type="submit" name="edit" class="btn btn-primary btn-sm">
						<% }else{ %>
							<button type="submit" name="edit" class="btn btn-defaut btn-sm" disabled>
						<% } %>
								<span class="glyphicon glyphicon-list-alt"></span> 查詢
							</button>
					</div>
				</div> <!-- col-md-3 -->

			</form>
			<div class="col-md-12">
				<% if (devices!=null && devices.length>0){ %>
					<table class="table table-striped table-hover">
					<tr>
						<td >溫度1</td>
						<td >濕度1</td>
						<% if (selectedType!=null && selectedType == 'd001'){ %>
							<td >溫度2</td>
							<td >濕度2</td>
						<% } %>
						<td >電壓</td>
						<td >時間</td>
					</tr>
					<% devices.forEach(function(device) { %>
						<% if (device.info) { %>
							<tr>
								<td><%= device.info.data0 %>度</td>
								<td><%= device.info.data1 %>%</td>
								<% if (selectedType!=null && selectedType == 'd001'){ %>
									<td><%= device.info.data2 %>度</td>
									<td><%= device.info.data3 %>%</td>
								<% } %>
							<td>
							<% if (device.info.data4) { %>
								<% if (device.info.data4>300) {  %>
									<button type="button" class="btn btn-success btn-sm" >
										<%= '正常('+ device.info.data4 +')' %> 　
									</button>　
								<% }else{ %>
									<button type="button" class="btn btn-danger btn-sm" >
										<%= '低電壓'+device.info.data4 %>
									</button>
								<% } %>
							<% } else { %>
								無資料
							<% } %>
							</td>


						<% }else{ %>
							<td>須更改<%= device.temperature1 %>度</td>
							<td><%= device.humidity1 %>%</td>
							<% if (selectedType!=null && selectedType == 'd001'){ %>
								<td><%= device.temperature2 %>度</td>
								<td><%= device.humidity2 %>%</td>
							<% } %>
							<td>
							<% if (device.voltage) { %>
								<% if (device.voltage>300) {  %>
									<button type="button" class="btn btn-success btn-sm" >
										<%= '正常('+device.voltage+')' %> 　
									</button>　
								<% }else{ %>
									<button type="button" class="btn btn-danger btn-sm" >
										<%= '低電壓'+device.voltage %>
									</button>
								<% } %>
							<% } else { %>
								無資料
							<% } %>
							</td>
						<% } %>


							<td>
								<% if (device.time) {  %>
									<%= device.time.date %>
								<% }else{ %>
									<%= device.recv_at %>
								<% } %>
							</td>
						</tr>
					<% }); %>
					</table>
				<% } %>
			</div> <!-- col -->
			<div class="col-md-12 column">
				<label id="error_message" class="checkbox">
		            <font color="red"><b></b>
		            <% if (user.authz.a05==false) { %>
		                你沒有查詢權限,請通知管理員變更權限!
		            <% } %>
		        </label>
			</div> <!-- column-->
		</div> <!-- panel-body -->


<script class="code" type="text/javascript">

	 $('#datepicker1').datepicker({dateFormat: 'yy-mm-dd', showOn: 'both',
    buttonImageOnly: true, buttonImage: 'images/calendar.png'});


</script>


<%- include page/footer %>